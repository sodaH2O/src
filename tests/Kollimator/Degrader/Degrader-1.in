OPTION, ECHO=FALSE;
OPTION, PSDUMPFREQ=10;

MINBINEMITTED = 1;

TITLE,STRING="degrader-1";

Edes   = 0.072;
gamma  = (Edes+PMASS)/PMASS;
beta   = sqrt(1-(1/gamma^2));
gambet = gamma*beta;
P0     = gamma*beta*PMASS;
brho   = (PMASS*1.0e9*gambet) / CLIGHT;
rf     = 50.6328;  //need to be confirmed

VALUE,{gamma,brho,Edes,beta,gambet};

DEGPHYS: PARTICLEMATTERINTERACTION, TYPE="DEGRADER", MATERIAL="Graphite";

DEG1: DEGRADER, L=0.01, ELEMEDGE=0.02, OUTFN="DEG1.h5", PARTICLEMATTERINTERACTION=DEGPHYS;

M0: Monitor, L=0.001, ELEMEDGE=0.010, OUTFN="M0.h5";
M1: Monitor, L=0.001, ELEMEDGE=0.035, OUTFN="M1.h5";

DEGTEST: LINE=(M0,DEG1,M1);

D1: DISTRIBUTION, DISTRIBUTION=GAUSS,
SIGMAX=  5.0e-03,   SIGMAPX=0.0,  CORRX=0.0,
SIGMAY=  5.0e-03,   SIGMAPY=0.0,  CORRY=0.0,
T     =  0.005,     SIGMAT= 0.0005,
SIGMAPT=0.0, CORRT=0.0, R61=0.0, INPUTMOUNITS=EV;

FS1:FIELDSOLVER, FSTYPE=NONE, MX=64, MY=64, MT=64,
                 PARFFTX=true, PARFFTY=true, PARFFTT=true,
                 BCFFTX=open, BCFFTY=open, BCFFTT=open,
                 BBOXINCR=1, GREENSF=STANDARD;

BEAM1: BEAM, PARTICLE=PROTON, PC=P0, NPART=1E6, BCURRENT=2.0e-03, BFREQ=rf, CHARGE=1;

SELECT, LINE=DEGTEST;

TRACK, LINE=DEGTEST, BEAM=BEAM1, MAXSTEPS=230, DT=1.0e-12;
 RUN, METHOD = "PARALLEL-T", BEAM=BEAM1, FIELDSOLVER=FS1, DISTRIBUTION=D1;
ENDTRACK;

STOP;
